<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulate Survival and Recurrent Event Data with reda • reda</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">reda</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/reda-intro.html">Introduction to reda through Examples</a>
    </li>
    <li>
      <a href="../articles/reda-simulate.html">Simulate Survival and Recurrent Event Data with reda</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wenjie2wang/reda">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Simulate Survival and Recurrent Event Data with reda</h1>
                        <h4 class="author">Wenjie Wang</h4>
            
            <h4 class="date">2017-12-09</h4>
          </div>

    
    
<div class="contents">
<p>In this vignette, we briefly introduce how to simulate survival and recurrent event data from stochastic process point of view with the <strong>reda</strong> package. The core function named <code>simEvent</code> provides an intuitive and flexible interface for simulating survival and recurrent event times from one stochastic process. Another function named <code>simEventData</code> is simply a wrapper that calls <code>simEvent</code> internally and collects the event times and the covariates of a given number of processes into a data frame. Examples of generating random samples from common survival and recurrent models are provided. The details of function syntax and the objects produced are available in the package manual and thus not covered in this vignette.</p>
<section id="intro" class="level1"><h1>Introduction</h1>
<section id="intensity" class="level2"><h2>Intensity function</h2>
<p>We first introduce the general form of hazard rate function considered and implemented in the function <code>simEvent</code>.</p>
<p>Consider <span class="math inline">\(n\)</span> stochastic processes with the baseline hazard rate function <span class="math inline">\(\rho(t)\)</span> of time <span class="math inline">\(t\)</span>. For the stochastic process <span class="math inline">\(i\)</span>, <span class="math inline">\(i\in\{1,\ldots,n\}\)</span>, let <span class="math inline">\(\mathbf{z}_i=(z_{i1},\ldots,z_{ip})^{\top}\)</span> denote the covariate vector of length <span class="math inline">\(p\)</span>, and <span class="math inline">\(\boldsymbol{\beta}=(\beta_1,\ldots,\beta_p)^{\top}\)</span> denote the covariate coefficients. We may incorporate the covariates and their coefficients into the stochastic process by specifying the intensity as a function of time <span class="math inline">\(t\)</span> and the covariates <span class="math inline">\(\mathbf{z}_i\)</span> as follows: <span class="math display">\[\lambda(t
\mid \mathbf{z}_i) = \rho(t)\,r(\mathbf{z}_i, \boldsymbol{\beta}),\]</span> where <span class="math inline">\(r(\mathbf{z}_i, \boldsymbol{\beta})\)</span> is the relative risk function. For the regular Cox model <span class="citation" data-cites="cox1972jrssb">(Cox 1972)</span> or the Andersen-Gill model <span class="citation" data-cites="andersen1982aos">(Andersen and Gill 1982)</span>, <span class="math inline">\(r(\mathbf{z}_i, \boldsymbol{\beta})= \exp\{\boldsymbol{\beta}^{\top}\mathbf{z}_i\}\)</span>. Other common choices include the linear relative risk model: <span class="math inline">\(r(\mathbf{z}_i, \boldsymbol{\beta}) = 1 + \boldsymbol{\beta}^{\top}\mathbf{z}_i\)</span>, and the excess relative risk model: <span class="math inline">\(r(\mathbf{z}_i, \boldsymbol{\beta}) = \prod_{j=1}^p(1 + \beta_j z_{ij})\)</span>.</p>
<p>We may extend the model by considering a random frailty effect <span class="math inline">\(w_i\)</span> (with expectation one) to account for heterogeneity between different processes or processes from different clusters. The intensity function becomes <span class="math display">\[\lambda(t
\mid \mathbf{z}_i, w_i) = \rho(t)\,r(\mathbf{z}_i, \boldsymbol{\beta})\,w_i.\]</span> The common choices for distribution of the random frailty effect include Gamma distribution of mean one, and lognormal distribution of mean zero in logarithm scale.</p>
<p>Furthermore, both covariates and coefficients may be time-varying. So the general form of the intensity function is given as follows: <span class="math display">\[\lambda\bigl(t
\mid \mathbf{z}_i(t), w_i\bigr) = \rho(t)\,r\bigl(\mathbf{z}_i(t),
\boldsymbol{\beta}(t)\bigr)\,w_i.\]</span></p>
</section><section id="sampling-methods" class="level2"><h2>Sampling methods</h2>
<p>The thinning method <span class="citation" data-cites="lewis1979nrlq">(Lewis and Shedler 1979)</span> and the inversion method <span class="citation" data-cites="cinlar1975printice">(Çinlar 1975)</span> are implemented for sampling event times. It can be shown that both methods achieve the given hazard rate. For function <code>simEvent</code>, the thinning method is the default method when the hazard rate function is bounded within follow-ups. Otherwise, the inversion method will be used. We may specify the sampling method via the argument <code>method</code> in function <code>simEvent</code> and <code>simEventData</code>.</p>
</section></section><section id="getting-started" class="level1"><h1>Getting started</h1>
<pre class="sourceCode r" id="cb1"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(reda)                    <span class="co"># attach reda package to the search path</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">packageVersion</span>(<span class="st">"reda"</span>)           <span class="co"># check the package version</span></a></code></pre>
<pre><code>## [1] '0.4.0.9000'</code></pre>
<pre class="sourceCode r" id="cb3"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">3</span>)              <span class="co"># set the number of significant digits to print</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">123</span>)                    <span class="co"># set random number seed</span></a></code></pre>
</section><section id="poisson-process" class="level1"><h1>Poisson process</h1>
<section id="hpp" class="level2"><h2>Homogeneous Poisson process</h2>
<p>A homogeneous/stationary Poisson process (HPP) has a constant hazard rate over time with the interarrival times (between two successive arrivals/events) following exponential distribution. Two simple examples of simulating a homogeneous Poisson process using <code>simEvent</code> are given as follows:</p>
<pre class="sourceCode r" id="cb4"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">## HPP from time 1 to 5 of intensity 1 without covariates</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="../reference/simEvent.html">simEvent</a></span>(<span class="dt">rho =</span> <span class="dv">1</span>, <span class="dt">origin =</span> <span class="dv">1</span>, <span class="dt">endTime =</span> <span class="dv">5</span>)</a></code></pre>
<pre><code>## 'simEvent' S4 class object:
## [1] 1.84 2.42 3.75 3.78 3.84 4.15 4.47 4.61</code></pre>
<pre class="sourceCode r" id="cb6"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">## HPP from 0 to 10 of baseline hazard rate 0.5 with two covariates</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="../reference/simEvent.html">simEvent</a></span>(<span class="dt">z =</span> <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.5</span>), <span class="dt">zCoef =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.1</span>), <span class="dt">rho =</span> <span class="fl">0.5</span>, <span class="dt">endTime =</span> <span class="dv">10</span>)</a></code></pre>
<pre><code>## 'simEvent' S4 class object:
## [1] 2.57 5.14 7.36</code></pre>
<p>The function <code>simEventData</code> enable us to simulate multiple processes and collect the simulated event times into a survival or recurrent event data format.</p>
<pre class="sourceCode r" id="cb8"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">## recurrent events from two processes with same covariates</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dv">2</span>, <span class="dt">z =</span> <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.5</span>), <span class="dt">zCoef =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>), <span class="dt">rho =</span> <span class="fl">0.5</span>, <span class="dt">endTime =</span> <span class="dv">5</span>)</a></code></pre>
<pre><code>##   ID  time event origin X.1 X.2
## 1  1 2.759     1      0 0.2 0.5
## 2  1 2.949     1      0 0.2 0.5
## 3  1 3.593     1      0 0.2 0.5
## 4  1 5.000     0      0 0.2 0.5
## 5  2 0.887     1      0 0.2 0.5
## 6  2 3.696     1      0 0.2 0.5
## 7  2 5.000     0      0 0.2 0.5</code></pre>
<p>In the example given above, the number of process is explicitly specified to be two. However, if it is not specified, it will be the number of rows of the covariate matrix. See the example given below.</p>
<pre class="sourceCode r" id="cb10"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">## recurrent events from two processes</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">## with different time-invariant covariates and time origins</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> <span class="kw">cbind</span>(<span class="kw">rnorm</span>(<span class="dv">2</span>), <span class="fl">0.5</span>), <span class="dt">zCoef =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">             <span class="dt">rho =</span> <span class="fl">0.2</span>, <span class="dt">origin =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">endTime =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">9</span>))</a></code></pre>
<pre><code>##   ID  time event origin    X.1 X.2
## 1  1  7.49     1      1 -1.072 0.5
## 2  1 10.00     0      1 -1.072 0.5
## 3  2  3.05     1      0  0.304 0.5
## 4  2  5.76     1      0  0.304 0.5
## 5  2  6.79     1      0  0.304 0.5
## 6  2  9.00     0      0  0.304 0.5</code></pre>
<p>We can also simulate survival data by taking the first event of each process. Setting <code>recurrent = FALSE</code> in function <code>simEvent</code> (or function <code>simEventData</code>) gives us the survival time(s) or the right censoring time(s). In the example given below, we specified <code>endTime = "rnorm"</code> and <code>arguments = list(endTime = list(mean = 10))</code> for generating a random censoring times from normal distribution with mean ten and unit standard deviation. Also note that the specified <code>origin</code> is recycled for these ten processes.</p>
<pre class="sourceCode r" id="cb12"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">## survival data by set 'recurrent = FALSE'</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> <span class="kw">cbind</span>(<span class="kw">rnorm</span>(<span class="dv">10</span>), <span class="dv">1</span>), <span class="dt">zCoef =</span> <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>), <span class="dt">rho =</span> <span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">             <span class="dt">origin =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">endTime =</span> <span class="st">"rnorm"</span>, <span class="dt">recurrent =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">             <span class="dt">arguments =</span> <span class="kw">list</span>(<span class="dt">endTime =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">10</span>)))</a></code></pre>
<pre><code>##    ID  time event origin      X.1 X.2
## 1   1  6.41     1      0  0.18130   1
## 2   2 10.24     0      1 -0.13889   1
## 3   3  3.95     1      0  0.00576   1
## 4   4  4.09     1      1  0.38528   1
## 5   5  9.44     0      0 -0.37066   1
## 6   6  8.33     0      1  0.64438   1
## 7   7  8.20     1      0 -0.22049   1
## 8   8  5.58     1      1  0.33178   1
## 9   9  1.24     1      0  1.09684   1
## 10 10  3.32     1      1  0.43518   1</code></pre>
</section><section id="nhpp" class="level2"><h2>Nonhomogeneous Poisson process</h2>
<p>In contrast to HPP, a nonhomogeneous Poisson process (NHPP) has a time-varying hazard rate function. In that case, we may specify the baseline hazard rate function <code>rho</code> to be a function object whose first argument represents the time variable. A quick example is given below, where the baseline hazard rate function <span class="math inline">\(\rho(t) = \sin(t) + 1\)</span>.</p>
<pre class="sourceCode r" id="cb14"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">rhoFun &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">b =</span> <span class="dv">1</span>) (<span class="kw">sin</span>(x) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>b</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw"><a href="../reference/simEvent.html">simEvent</a></span>(<span class="dt">rho =</span> rhoFun)</a></code></pre>
<pre><code>## 'simEvent' S4 class object:
## [1] 0.865 1.521 2.168 2.402 2.418 2.495</code></pre>
<p>As demonstrated in the last example for HPP, other possible arguments of the function objects can be specified via the <code>arguments</code>. For example, that <code>arguments = list(rho = list(b = 0.5))</code> specifies the baseline hazard rate function to be <span class="math inline">\(\rho(t) = 0.5(\sin(t) + 1)\)</span>.</p>
<pre class="sourceCode r" id="cb16"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> <span class="kw">cbind</span>(<span class="kw">rexp</span>(<span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)), <span class="dt">zCoef =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">             <span class="dt">rho =</span> rhoFun, <span class="dt">arguments =</span> <span class="kw">list</span>(<span class="dt">rho =</span> <span class="kw">list</span>(<span class="dt">b =</span> <span class="fl">0.5</span>)))</a></code></pre>
<pre><code>##   ID time event origin   X.1 X.2
## 1  1 0.48     1      0 4.210   0
## 2  1 1.21     1      0 4.210   0
## 3  1 1.61     1      0 4.210   0
## 4  1 2.05     1      0 4.210   0
## 5  1 3.00     0      0 4.210   0
## 6  2 1.72     1      0 0.963   1
## 7  2 2.57     1      0 0.963   1
## 8  2 3.00     0      0 0.963   1</code></pre>
</section></section><section id="renewal-processes" class="level1"><h1>Renewal processes</h1>
<p>In the Poisson process, the interarrival times between two successive arrivals (or events) follow exponential distribution independently. We may generalize the distribution of interarrival times and consider more general renewal processes.</p>
<p>In function <code>simEvent</code> (and <code>simEventData</code>), we may specify the distribution of the interarrival times via the argument <code>interarrival</code>, which takes the function name <code>"rexp"</code> (from the <strong>stats</strong> package) for generating interarrival times following exponential distribution by default. In general, the argument <code>interarrival</code> takes a function with at least one argument named <code>rate</code> for generating random (nonnegative) interarrival times from a certain distribution at the given arrival rate. A quick example of generating the interarrival times following Gamma distribution of scale one is given as follows:</p>
<pre class="sourceCode r" id="cb18"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw"><a href="../reference/simEvent.html">simEvent</a></span>(<span class="dt">interarrival =</span> <span class="cf">function</span>(n, rate) <span class="kw">rgamma</span>(n, <span class="dt">shape =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>rate))</a></code></pre>
<pre><code>## 'simEvent' S4 class object:
## [1] 0.182 1.878</code></pre>
<p>If the specified function has an argument named <code>n</code>, the function <code>simEvent</code> will assume that the function can generate <code>n</code> number of random interarrival times at one time and take advantage of the vectorization for a potentially better performance. However, it is optional. The example given below produces an equivalent result.</p>
<pre class="sourceCode r" id="cb20"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="kw"><a href="../reference/simEvent.html">simEvent</a></span>(<span class="dt">interarrival =</span> <span class="cf">function</span>(rate) <span class="kw">rgamma</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">shape =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>rate))</a></code></pre>
<pre><code>## 'simEvent' S4 class object:
## [1] 0.182 1.878</code></pre>
</section><section id="beyond-time-invariance" class="level1"><h1>Beyond time-invariance</h1>
<section id="time-variant-covariates" class="level2"><h2>Time-variant covariates</h2>
<p>In pratice, some covariates such as patients’ age, automobile’s mileage may vary over time. The argument <code>z</code> in the function <code>simEvent</code> and <code>simEventData</code> may take a function of time that returns a vector of covariates for generating event times with the time-varying covariates. Let’s consider an example of generating recurrent event times with three covariates, where two of which are time-variant.</p>
<pre class="sourceCode r" id="cb22"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">zFun1 &lt;-<span class="st"> </span><span class="cf">function</span>(time) <span class="kw">c</span>(time <span class="op">/</span><span class="st"> </span><span class="dv">10</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="kw">as.numeric</span>(time <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>), <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> zFun1, <span class="dt">zCoef =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>))</a></code></pre>
<pre><code>##   ID  time event origin  X.1 X.2 X.3
## 1  1 0.577     1      0 1.06   0 0.5
## 2  1 1.880     1      0 1.19   1 0.5
## 3  1 1.902     1      0 1.19   1 0.5
## 4  1 1.940     1      0 1.19   1 0.5
## 5  1 2.156     1      0 1.22   1 0.5
## 6  1 2.371     1      0 1.24   1 0.5
## 7  1 2.471     1      0 1.25   1 0.5
## 8  1 3.000     0      0 1.30   1 0.5</code></pre>
<p>In the example given above, the covariate vector is <span class="math inline">\(\mathbf{z}(t)=(0.1t+1, \boldsymbol{1}(t &gt; 1), 0.5)^{\top}\)</span>. If the covariate function has more arguments, we may specify them by a named list in <code>arguments</code>. The example given below produces the equivalent results.</p>
<pre class="sourceCode r" id="cb24"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">zFun2 &lt;-<span class="st"> </span><span class="cf">function</span>(x, a, b) <span class="kw">c</span>(x <span class="op">/</span><span class="st"> </span><span class="dv">10</span> <span class="op">+</span><span class="st"> </span>a, <span class="kw">as.numeric</span>(x <span class="op">&gt;</span><span class="st"> </span>b), <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> zFun2, <span class="dt">zCoef =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb24-4" data-line-number="4">             <span class="dt">arguments =</span> <span class="kw">list</span>(<span class="dt">z =</span> <span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">1</span>)))</a></code></pre>
<pre><code>##   ID  time event origin  X.1 X.2 X.3
## 1  1 0.577     1      0 1.06   0 0.5
## 2  1 1.880     1      0 1.19   1 0.5
## 3  1 1.902     1      0 1.19   1 0.5
## 4  1 1.940     1      0 1.19   1 0.5
## 5  1 2.156     1      0 1.22   1 0.5
## 6  1 2.371     1      0 1.24   1 0.5
## 7  1 2.471     1      0 1.25   1 0.5
## 8  1 3.000     0      0 1.30   1 0.5</code></pre>
<p>Notice that in the examples given above, if we generate event times for more than one process, the time-varying covariate function will remain the same for different processes, which may not be the case in pratice. A more realistic situation is that the time-variant covariate functions are different among different processes but coming from a common function family. Let’s consider the Stanford heart transplant data <span class="citation" data-cites="crowley1977jasa">(Crowley and Hu 1977)</span> as an example (the <code>heart</code> data available in the <strong>survival</strong> package). The covariate <code>transplant</code> indicating whether the patient has already received a heart transplant before time <code>t</code> is time-dependent and can be represented by a indicator function family, <span class="math inline">\(\boldsymbol{1}(t &gt; b)\)</span>, where <span class="math inline">\(b\)</span> is a known parameter that may differ among patients. For a perticular patient <span class="math inline">\(i\)</span>, <span class="math inline">\(b = b_i\)</span> is a known constant. In that case, we specify the function parameters inside the <code>quote</code> function as follows:</p>
<pre class="sourceCode r" id="cb26"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">zFun3 &lt;-<span class="st"> </span><span class="cf">function</span>(time, a, b) <span class="kw">c</span>(time <span class="op">/</span><span class="st"> </span><span class="dv">10</span> <span class="op">+</span><span class="st"> </span>a, <span class="kw">as.numeric</span>(time <span class="op">&gt;</span><span class="st"> </span>b))</a>
<a class="sourceLine" id="cb26-2" data-line-number="2">(simDat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">nProcess =</span> <span class="dv">3</span>, <span class="dt">z =</span> zFun3, <span class="dt">zCoef =</span> <span class="kw">c</span>(<span class="op">-</span><span class="st"> </span><span class="fl">0.1</span>, <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">                        <span class="dt">arguments =</span> <span class="kw">list</span>(<span class="dt">z =</span> <span class="kw">list</span>(<span class="dt">a =</span> <span class="kw">quote</span>(<span class="kw">rpois</span>(<span class="dv">1</span>, <span class="dv">10</span>) <span class="op">/</span><span class="st"> </span><span class="dv">10</span>),</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">                                                  <span class="dt">b =</span> <span class="kw">quote</span>(<span class="kw">runif</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>))))))</a></code></pre>
<pre><code>##    ID  time event origin   X.1 X.2
## 1   1 1.045     1      0 0.905   0
## 2   1 1.066     1      0 0.907   0
## 3   1 1.464     1      0 0.946   1
## 4   1 2.907     1      0 1.091   1
## 5   1 3.000     0      0 1.100   1
## 6   2 0.214     1      0 1.321   0
## 7   2 0.961     1      0 1.396   0
## 8   2 1.180     1      0 1.418   0
## 9   2 1.862     1      0 1.486   1
## 10  2 3.000     0      0 1.600   1
## 11  3 0.524     1      0 1.052   0
## 12  3 0.571     1      0 1.057   0
## 13  3 0.924     1      0 1.092   0
## 14  3 1.635     1      0 1.164   0
## 15  3 2.268     1      0 1.227   0
## 16  3 2.507     1      0 1.251   1
## 17  3 3.000     0      0 1.300   1</code></pre>
<p>In the example given above, the covariate <code>X.2</code> is simulated from the indicator function famliy, <span class="math inline">\(\boldsymbol{1}(t &gt; b)\)</span>, where parameter <span class="math inline">\(b\)</span> follows uniform distribution between 1 and 3. Internally, the parameters specified in <code>arguments</code> were evaluated for each process. We may check the values of the parameter <code>a</code> from the generated covariate <code>X.1</code> for different processes as follows:</p>
<pre class="sourceCode r" id="cb28"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">## check the values of parameter `a` for different processes</a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="kw">with</span>(simDat, <span class="kw">unique</span>(<span class="kw">cbind</span>(ID, <span class="dt">a =</span> X<span class="fl">.1</span> <span class="op">-</span><span class="st"> </span>time <span class="op">/</span><span class="st"> </span><span class="dv">10</span>)))</a></code></pre>
<pre><code>##      ID   a
## [1,]  1 0.8
## [2,]  2 1.3
## [3,]  3 1.0</code></pre>
</section><section id="time-variant-covariate-coefficients" class="level2"><h2>Time-variant covariate coefficients</h2>
<p>The assumption of time-invariance on the covariate coefficients can be hard to justify in practice. We may simulate event times with time-varying covariate coefficients by specifying the argument <code>zCoef</code> to be a function of time that returns a vector of coefficients at the input time point. How we may specify the argument <code>zCoef</code> for time-varying coefficients is very similar to the way we may specify the argument <code>z</code> for time-varying covariates introduced in last section. For example, we may generate event times with both covariates and their coefficients being time-variant as follows:</p>
<pre class="sourceCode r" id="cb30"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">zCoefFun &lt;-<span class="st"> </span><span class="cf">function</span>(time, shift) <span class="kw">c</span>(<span class="kw">sqrt</span>(time <span class="op">/</span><span class="st"> </span><span class="dv">10</span>), <span class="kw">sin</span>(time <span class="op">+</span><span class="st"> </span>shift), <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> zFun1, <span class="dt">zCoef =</span> zCoefFun,</a>
<a class="sourceLine" id="cb30-3" data-line-number="3">             <span class="dt">arguments =</span> <span class="kw">list</span>(<span class="dt">zCoef =</span> <span class="kw">list</span>(<span class="dt">shift =</span> <span class="dv">1</span>)))</a></code></pre>
<pre><code>##   ID  time event origin  X.1 X.2 X.3
## 1  1 0.643     1      0 1.06   0 0.5
## 2  1 1.198     1      0 1.12   1 0.5
## 3  1 1.268     1      0 1.13   1 0.5
## 4  1 1.770     1      0 1.18   1 0.5
## 5  1 2.296     1      0 1.23   1 0.5
## 6  1 2.405     1      0 1.24   1 0.5
## 7  1 2.773     1      0 1.28   1 0.5
## 8  1 3.000     0      0 1.30   1 0.5</code></pre>
<p>As demonstrated in the example given above, we may similarly specify the other arguments of the time-varying coefficient function via a named list in <code>arguments</code>.</p>
</section></section><section id="frailty" class="level1"><h1>Frailty models</h1>
<section id="individual-frailty" class="level2"><h2>Frailty for individual processes</h2>
<p>Let’s consider frailty factors for individual processes first, where each process <span class="math inline">\(i\)</span> has its own frailty effect <span class="math inline">\(w_i\)</span>. A popular choice of the frailty distribution is the one-parameter gamma distribution of mean one, which often leads to an explicit marginal likelihood in a relatively simple expression. Similar to the argument <code>z</code>, <code>zCoef</code>, and <code>rho</code>, the argument <code>frailty</code> may take a fucntion as input for simulating the frailty effect. For example, we may simulate the recurrent event times for one process with frailty factor following gamma(2, 0.5) via <code>frailty = "rgamma"</code> and <code>arguments = list(frailty = list(shape = 2, scale = 0.5))</code> as follows:</p>
<pre class="sourceCode r" id="cb32"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> zFun1, <span class="dt">zCoef =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>), <span class="dt">frailty =</span> <span class="st">"rgamma"</span>,</a>
<a class="sourceLine" id="cb32-3" data-line-number="3">             <span class="dt">arguments =</span> <span class="kw">list</span>(<span class="dt">frailty =</span> <span class="kw">list</span>(<span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">scale =</span> <span class="fl">0.5</span>)))</a></code></pre>
<pre><code>##   ID time event origin  X.1 X.2 X.3
## 1  1 1.10     1      0 1.11   1 0.5
## 2  1 1.32     1      0 1.13   1 0.5
## 3  1 3.00     0      0 1.30   1 0.5</code></pre>
<p>The named list <code>list(shape = 2, scale = 0.5)</code> was passed to the function <code>rgamma</code> (from the <strong>stats</strong> package). The random number seed was reset so that we might compare the results with the first example of time-variant covariates. Note that it is users’ job to make sure the specified distribution of the frailty factor has mean one (or makes sense in a certain way). The function <code>simEvent</code> and <code>simEventData</code> only check the sign of the simulated frailty effect. An error will be thrown out if the generated frailty effect is not positive.</p>
<p>To demonstrate how to specify other distribution of the frailty factor, we simulate the recurrent event times for one process by three slightly different but equivalent approaches in the following examples, where the frailty effect follows log-normal distribution of mean one.</p>
<pre class="sourceCode r" id="cb34"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb34-2" data-line-number="2">## use function `rlnorm` from the stats package</a>
<a class="sourceLine" id="cb34-3" data-line-number="3"><span class="kw"><a href="../reference/simEvent.html">simEvent</a></span>(<span class="dt">z =</span> zFun1, <span class="dt">zCoef =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>), <span class="dt">frailty =</span> <span class="st">"rlnorm"</span>,</a>
<a class="sourceLine" id="cb34-4" data-line-number="4">         <span class="dt">arguments =</span> <span class="kw">list</span>(<span class="dt">frailty =</span> <span class="kw">list</span>(<span class="dt">sdlog =</span> <span class="dv">1</span>)))</a></code></pre>
<pre><code>## 'simEvent' S4 class object:
## [1] 1.59 1.63 1.70 2.08 2.45 2.63</code></pre>
<pre class="sourceCode r" id="cb36"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb36-2" data-line-number="2">## use a customized function with argument `n` and `sdlog`</a>
<a class="sourceLine" id="cb36-3" data-line-number="3">logNorm1 &lt;-<span class="st"> </span><span class="cf">function</span>(n, sdlog) <span class="kw">exp</span>(<span class="kw">rnorm</span>(<span class="dt">n =</span> n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> sdlog))</a>
<a class="sourceLine" id="cb36-4" data-line-number="4"><span class="kw"><a href="../reference/simEvent.html">simEvent</a></span>(<span class="dt">z =</span> zFun1, <span class="dt">zCoef =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>), <span class="dt">frailty =</span> logNorm1,</a>
<a class="sourceLine" id="cb36-5" data-line-number="5">         <span class="dt">arguments =</span> <span class="kw">list</span>(<span class="dt">frailty =</span> <span class="kw">list</span>(<span class="dt">sdlog =</span> <span class="dv">1</span>)))</a></code></pre>
<pre><code>## 'simEvent' S4 class object:
## [1] 1.59 1.63 1.70 2.08 2.45 2.63</code></pre>
<pre class="sourceCode r" id="cb38"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb38-2" data-line-number="2">## use a customized function with argument `sdlog` only</a>
<a class="sourceLine" id="cb38-3" data-line-number="3">logNorm2 &lt;-<span class="st"> </span><span class="cf">function</span>(sdlog) <span class="kw">exp</span>(<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> sdlog))</a>
<a class="sourceLine" id="cb38-4" data-line-number="4"><span class="kw"><a href="../reference/simEvent.html">simEvent</a></span>(<span class="dt">z =</span> zFun1, <span class="dt">zCoef =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>), <span class="dt">frailty =</span> logNorm2,</a>
<a class="sourceLine" id="cb38-5" data-line-number="5">         <span class="dt">arguments =</span> <span class="kw">list</span>(<span class="dt">frailty =</span> <span class="kw">list</span>(<span class="dt">sdlog =</span> <span class="dv">1</span>)))</a></code></pre>
<pre><code>## 'simEvent' S4 class object:
## [1] 1.59 1.63 1.70 2.08 2.45 2.63</code></pre>
<p>If the function specified for <code>frailty</code> has an argument named <code>n</code>, that <code>n = 1</code> will be specified internally by the function <code>simEvent</code>, which is designed for using the functions generating random numbers, such as <code>rgamma</code> and <code>rlnorm</code> from the <strong>stats</strong> package.</p>
</section><section id="shared-frailty" class="level2"><h2>Shared frailty for clusters</h2>
<p>When different processes come from several clusters, we may consider a same frailty effect shared among processes within a cluster. The case we considered in last section where frailty factors are different among individual processes is a special case when the cluster size is one.</p>
<p>In the function <code>simEvent</code> (<code>simEventData</code>), the argument <code>frailty</code> may take a numeric number (vector) as input for specific shared frailty effect for clusters. For instance, we may simulate the recurrent event times for four processes coming from two clusters with shared gamma frailty within cluster, where the first two processes come from one cluster while the remaining two come from another cluster.</p>
<pre class="sourceCode r" id="cb40"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">## shared gamma frailty for processes from two clusters</a>
<a class="sourceLine" id="cb40-2" data-line-number="2">frailtyEffect &lt;-<span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">2</span>, <span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">scale =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb40-3" data-line-number="3"><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">nProcess =</span> <span class="dv">4</span>, <span class="dt">frailty =</span> <span class="kw">rep</span>(frailtyEffect, <span class="dt">each =</span> <span class="dv">2</span>))</a></code></pre>
<pre><code>##    ID  time event origin X
## 1   1 0.720     1      0 0
## 2   1 1.828     1      0 0
## 3   1 2.834     1      0 0
## 4   1 3.000     0      0 0
## 5   2 1.230     1      0 0
## 6   2 2.051     1      0 0
## 7   2 3.000     0      0 0
## 8   3 1.254     1      0 0
## 9   3 3.000     0      0 0
## 10  4 0.531     1      0 0
## 11  4 0.864     1      0 0
## 12  4 1.515     1      0 0
## 13  4 1.574     1      0 0
## 14  4 2.020     1      0 0
## 15  4 2.919     1      0 0
## 16  4 3.000     0      0 0</code></pre>
<p>If the length of the specified frailty vector is less than the number of processes, the vector will be recycled internally. In the example given below, the process 1 and process 3 shared a same frailty effect (<code>frailtyEffect[1L]</code>). Similarly, the process 2 and process 4 shared a same frailty effect (<code>frailtyEffect[2L]</code>).</p>
<pre class="sourceCode r" id="cb42"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">nProcess =</span> <span class="dv">4</span>, <span class="dt">frailty =</span> frailtyEffect)</a></code></pre>
<pre><code>##    ID  time event origin X
## 1   1 0.629     1      0 0
## 2   1 1.059     1      0 0
## 3   1 2.050     1      0 0
## 4   1 2.074     1      0 0
## 5   1 2.116     1      0 0
## 6   1 2.352     1      0 0
## 7   1 2.586     1      0 0
## 8   1 2.695     1      0 0
## 9   1 3.000     0      0 0
## 10  2 1.882     1      0 0
## 11  2 3.000     0      0 0
## 12  3 0.917     1      0 0
## 13  3 1.506     1      0 0
## 14  3 1.976     1      0 0
## 15  3 2.912     1      0 0
## 16  3 3.000     0      0 0
## 17  4 3.000     0      0 0</code></pre>
</section></section><section id="common-survival-models" class="level1"><h1>Common survival models</h1>
<p>In this section, we present examples for generating event times with time-invariant covariates for several common survival models.</p>
<section id="weibull-model" class="level2"><h2>Weibull model</h2>
<p>The Weibull model is one of the most widely used parametric survival models. Assume the event times of the process <span class="math inline">\(i\)</span>, <span class="math inline">\(i\in\{1,\ldots,n\}\)</span>, follow Weibull model with hazard function <span class="math inline">\(h_i(t) = \lambda_i p t^{p-1}\)</span>, where <span class="math inline">\(p&gt;0\)</span> is the shape parameter, and <span class="math inline">\(\lambda_i\)</span> can be reparameterized with regression coefficients.</p>
<p>The common reparameterization is <span class="math inline">\(\lambda_i = \exp(\beta_0 + \boldsymbol{\beta}^{\top}\mathbf{z}_i)\)</span>, which results in Weibull proportional hazard model. Let <span class="math inline">\(\lambda_0 = \exp(\beta_0)\)</span> and we may rewrite the hazard function <span class="math inline">\(h_i(t) = \rho(t) \exp(\boldsymbol{\beta}^{\top}\mathbf{z}_i)\)</span>, where <span class="math inline">\(\rho(t) = \lambda_0 p t^{p-1}\)</span> is the baseline hazard function.</p>
<pre class="sourceCode r" id="cb44"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">weibull_ph &lt;-<span class="st"> </span><span class="cf">function</span>(x, lambda, p) lambda <span class="op">*</span><span class="st"> </span>p <span class="op">*</span><span class="st"> </span>x <span class="op">^</span><span class="st"> </span>(p <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb44-2" data-line-number="2"><span class="kw"><a href="../reference/simEvent.html">simEventData</a></span>(<span class="dt">z =</span> <span class="kw">cbind</span>(<span class="kw">rnorm</span>(<span class="dv">2</span>), <span class="kw">rbinom</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)),</a>
<a class="sourceLine" id="cb44-3" data-line-number="3">             <span class="dt">zCoef =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.2</span>), <span class="dt">rho =</span> weibull_ph,</a>
<a class="sourceLine" id="cb44-4" data-line-number="4">             <span class="dt">arguments =</span> <span class="kw">list</span>(<span class="dt">rho =</span> <span class="kw">list</span>(<span class="dt">lambda =</span> <span class="fl">0.1</span>, <span class="dt">p =</span> <span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb44-5" data-line-number="5">             <span class="dt">recurrent =</span> <span class="ot">FALSE</span>, <span class="dt">end =</span> <span class="dv">5</span>)</a></code></pre>
<pre><code>##   ID time event origin    X.1 X.2
## 1  1 1.34     1      0  0.380   0
## 2  2 1.85     1      0 -0.502   1</code></pre>
</section><section id="log-normal-model" class="level2"><h2>Log-normal model</h2>
</section><section id="log-logistic-model" class="level2"><h2>Log-logistic model</h2>
</section></section><section id="multiple-event-data" class="level1"><h1>Multiple event data</h1>
</section><section id="reference" class="level1 unnumbered"><h1>Reference</h1>
<div id="refs" class="references">
<div id="ref-andersen1982aos">
<p>Andersen, Per Kragh, and Richard David Gill. 1982. “Cox’s Regression Model for Counting Processes: A Large Sample Study.” <em>The Annals of Statistics</em> 10 (4). JSTOR:1100–1120.</p>
</div>
<div id="ref-cinlar1975printice">
<p>Çinlar, Erhan. 1975. <em>Introduction to Stochastic Processes</em>. Englewood Cliffs, NJ: Printice-Hall.</p>
</div>
<div id="ref-cox1972jrssb">
<p>Cox, David R. 1972. “Regression Models and Life-Tables.” <em>Journal of the Royal Statistical Society. Series B (Methodological)</em> 34 (2). JSTOR:187–220.</p>
</div>
<div id="ref-crowley1977jasa">
<p>Crowley, John, and Marie Hu. 1977. “Covariance Analysis of Heart Transplant Survival Data.” <em>Journal of the American Statistical Association</em> 72 (357). Taylor &amp; Francis Group:27–36.</p>
</div>
<div id="ref-lewis1979nrlq">
<p>Lewis, P A, and G S Shedler. 1979. “Simulation of Nonhomogeneous Poisson Processes by Thinning.” <em>Naval Research Logistics Quarterly</em> 26 (3). Wiley Online Library:403–13.</p>
</div>
</div>
</section>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#intro">Introduction</a><ul class="nav nav-pills nav-stacked">
<li><a href="#intensity">Intensity function</a></li>
      <li><a href="#sampling-methods">Sampling methods</a></li>
      </ul>
</li>
      <li><a href="#getting-started">Getting started</a></li>
      <li>
<a href="#poisson-process">Poisson process</a><ul class="nav nav-pills nav-stacked">
<li><a href="#hpp">Homogeneous Poisson process</a></li>
      <li><a href="#nhpp">Nonhomogeneous Poisson process</a></li>
      </ul>
</li>
      <li><a href="#renewal-processes">Renewal processes</a></li>
      <li>
<a href="#beyond-time-invariance">Beyond time-invariance</a><ul class="nav nav-pills nav-stacked">
<li><a href="#time-variant-covariates">Time-variant covariates</a></li>
      <li><a href="#time-variant-covariate-coefficients">Time-variant covariate coefficients</a></li>
      </ul>
</li>
      <li>
<a href="#frailty">Frailty models</a><ul class="nav nav-pills nav-stacked">
<li><a href="#individual-frailty">Frailty for individual processes</a></li>
      <li><a href="#shared-frailty">Shared frailty for clusters</a></li>
      </ul>
</li>
      <li>
<a href="#common-survival-models">Common survival models</a><ul class="nav nav-pills nav-stacked">
<li><a href="#weibull-model">Weibull model</a></li>
      <li><a href="#log-normal-model">Log-normal model</a></li>
      <li><a href="#log-logistic-model">Log-logistic model</a></li>
      </ul>
</li>
      <li><a href="#multiple-event-data">Multiple event data</a></li>
      <li><a href="#reference">Reference</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Wenjie Wang, Haoda Fu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
